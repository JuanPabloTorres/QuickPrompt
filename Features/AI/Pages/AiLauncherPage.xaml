<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="QuickPrompt.Features.AI.Pages.AiLauncherPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:controls="clr-namespace:QuickPrompt.Controls"
    xmlns:viewModels="clr-namespace:QuickPrompt.ViewModels"
    xmlns:views="clr-namespace:QuickPrompt.Views"
    Title="AI Engines"
    x:DataType="viewModels:AiLauncherViewModel"
    BackgroundColor="{StaticResource AppBackground}">

    <ScrollView>
        <VerticalStackLayout Padding="16" Spacing="20">

            <!--  Header Section  -->
            <VerticalStackLayout Spacing="8">
                <Label
                    FontAttributes="Bold"
                    Style="{StaticResource Heading1TextStyle}"
                    Text="ðŸš€ Launch AI Engine"
                    TextColor="{StaticResource PrimaryBlueDark}" />
                <Label
                    Opacity="0.8"
                    Style="{StaticResource BodySmallTextStyle}"
                    Text="Select an AI engine to send your prompt"
                    TextColor="{StaticResource TextSecondary}" />
            </VerticalStackLayout>

            <!--  AI Providers Grid  -->
            <VerticalStackLayout Spacing="12">
                <Label
                    Margin="0,8,0,0"
                    FontAttributes="Bold"
                    Style="{StaticResource BodyLargeTextStyle}"
                    Text="Available Engines"
                    TextColor="{StaticResource PrimaryBlueDark}" />

                <!--  ChatGPT  -->
                <controls:AIProviderButton
                    Command="{Binding LaunchEngineCommand}"
                    CommandParameter="ChatGPT"
                    ProviderColor="#10A37F"
                    ProviderDescription="OpenAI's conversational AI"
                    ProviderMaterialIcon="&#xe0c3;"
                    ProviderName="ChatGPT"
                    ShowArrow="True"
                    ShowDescription="True"
                    ShowMaterialIcon="True" />

                <!--  Gemini  -->
                <controls:AIProviderButton
                    Command="{Binding LaunchEngineCommand}"
                    CommandParameter="Gemini"
                    ProviderColor="#8AB4F8"
                    ProviderDescription="Google's multimodal AI"
                    ProviderMaterialIcon="&#xe8b5;"
                    ProviderName="Gemini"
                    ShowArrow="True"
                    ShowDescription="True"
                    ShowMaterialIcon="True" />

                <!--  Grok  -->
                <controls:AIProviderButton
                    Command="{Binding LaunchEngineCommand}"
                    CommandParameter="Grok"
                    ProviderColor="#000000"
                    ProviderDescription="X's real-time AI"
                    ProviderMaterialIcon="&#xf06c;"
                    ProviderName="Grok"
                    ShowArrow="True"
                    ShowDescription="True"
                    ShowMaterialIcon="True" />

                <!--  Copilot  -->
                <controls:AIProviderButton
                    Command="{Binding LaunchEngineCommand}"
                    CommandParameter="Copilot"
                    ProviderColor="#0078D4"
                    ProviderDescription="Microsoft's AI assistant"
                    ProviderMaterialIcon="&#xe8fd;"
                    ProviderName="Copilot"
                    ShowArrow="True"
                    ShowDescription="True"
                    ShowMaterialIcon="True" />
            </VerticalStackLayout>

            <!--  Recent Prompts Section  -->
            <VerticalStackLayout Margin="0,20,0,0" Spacing="12">
                <Grid ColumnDefinitions="*,Auto">
                    <Label
                        Grid.Column="0"
                        FontAttributes="Bold"
                        Style="{StaticResource BodyLargeTextStyle}"
                        Text="Recent Prompts"
                        TextColor="{StaticResource PrimaryBlueDark}"
                        VerticalOptions="Center" />

                    <Button
                        Grid.Column="1"
                        Padding="8,4"
                        BackgroundColor="Transparent"
                        BorderWidth="0"
                        Command="{Binding ClearCommand}"
                        IsVisible="{Binding FinalPrompts.Count, Converter={StaticResource IntToBoolConverter}}"
                        Style="{StaticResource ButtonTextStyle}"
                        Text="Clear All"
                        TextColor="{StaticResource Danger}" />
                </Grid>

                <!--  Empty State  -->
                <Border
                    Padding="32,24"
                    BackgroundColor="{StaticResource CardBackground}"
                    IsVisible="{Binding FinalPrompts.Count, Converter={StaticResource IntToInverseBoolConverter}}"
                    Stroke="{StaticResource BorderColor}"
                    StrokeThickness="1">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="12" />
                    </Border.StrokeShape>
                    <VerticalStackLayout HorizontalOptions="Center" Spacing="12">
                        <Label
                            FontFamily="MaterialIconsOutlined-Regular"
                            FontSize="48"
                            HorizontalOptions="Center"
                            Opacity="0.3"
                            Text="&#xf0eb;"
                            TextColor="{StaticResource TextSecondary}" />
                        <Label
                            FontAttributes="Bold"
                            HorizontalOptions="Center"
                            Style="{StaticResource BodyLargeTextStyle}"
                            Text="No recent prompts"
                            TextColor="{StaticResource TextSecondary}" />
                        <Label
                            HorizontalOptions="Center"
                            Opacity="0.7"
                            Style="{StaticResource CaptionTextStyle}"
                            Text="Complete a prompt to see it here"
                            TextColor="{StaticResource TextSecondary}" />
                    </VerticalStackLayout>
                </Border>

                <!--  Prompts List  -->
                <CollectionView
                    IsVisible="{Binding FinalPrompts.Count, Converter={StaticResource IntToBoolConverter}}"
                    ItemsSource="{Binding FinalPrompts}"
                    SelectionMode="None">
                    <CollectionView.ItemTemplate>
                        <DataTemplate x:DataType="x:String">
                            <SwipeView>
                                <!--  Swipe to Delete  -->
                                <SwipeView.RightItems>
                                    <SwipeItems Mode="Execute">
                                        <SwipeItem
                                            BackgroundColor="{StaticResource Danger}"
                                            Command="{Binding Source={RelativeSource AncestorType={x:Type viewModels:AiLauncherViewModel}}, Path=DeleteFinalPromptCommand}"
                                            CommandParameter="{Binding .}"
                                            Text="Delete" />
                                    </SwipeItems>
                                </SwipeView.RightItems>

                                <Border
                                    Margin="0,4"
                                    Padding="16"
                                    BackgroundColor="{StaticResource CardBackground}"
                                    Stroke="{StaticResource BorderColor}"
                                    StrokeThickness="1">
                                    <Border.StrokeShape>
                                        <RoundRectangle CornerRadius="8" />
                                    </Border.StrokeShape>

                                    <Border.GestureRecognizers>
                                        <TapGestureRecognizer Command="{Binding Source={RelativeSource AncestorType={x:Type viewModels:AiLauncherViewModel}}, Path=SelectPromptCommand}" CommandParameter="{Binding .}" />
                                    </Border.GestureRecognizers>

                                    <Grid ColumnDefinitions="*,Auto" ColumnSpacing="12">
                                        <Label
                                            Grid.Column="0"
                                            LineBreakMode="TailTruncation"
                                            MaxLines="2"
                                            Style="{StaticResource BodySmallTextStyle}"
                                            Text="{Binding .}"
                                            TextColor="{StaticResource TextPrimary}"
                                            VerticalOptions="Center" />

                                        <Label
                                            Grid.Column="1"
                                            FontFamily="MaterialIconsOutlined-Regular"
                                            Style="{StaticResource Heading2TextStyle}"
                                            Text="&#xe5cc;"
                                            TextColor="{StaticResource PrimaryBlueLight}"
                                            VerticalOptions="Center" />
                                    </Grid>
                                </Border>
                            </SwipeView>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
            </VerticalStackLayout>

            <!--  Quick Actions  -->
            <VerticalStackLayout Margin="0,20,0,20" Spacing="12">
                <Label
                    FontAttributes="Bold"
                    Style="{StaticResource BodyLargeTextStyle}"
                    Text="Quick Actions"
                    TextColor="{StaticResource PrimaryBlueDark}" />

                <Grid ColumnDefinitions="*,*" ColumnSpacing="12">
                    <!--  Go to Quick Prompts  -->
                    <Border
                        Grid.Column="0"
                        Padding="16,12"
                        BackgroundColor="{StaticResource PrimaryBlueLight}"
                        StrokeThickness="0">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="8" />
                        </Border.StrokeShape>
                        <Border.GestureRecognizers>
                            <TapGestureRecognizer Command="{Binding GoToQuickPromptsCommand}" />
                        </Border.GestureRecognizers>
                        <VerticalStackLayout HorizontalOptions="Center" Spacing="4">
                            <Label
                                FontFamily="MaterialIconsOutlined-Regular"
                                FontSize="24"
                                HorizontalOptions="Center"
                                Text="&#xea0b;"
                                TextColor="White" />
                            <Label
                                FontAttributes="Bold"
                                HorizontalOptions="Center"
                                Style="{StaticResource CaptionTextStyle}"
                                Text="Quick"
                                TextColor="White" />
                        </VerticalStackLayout>
                    </Border>

                    <!--  Go to Create  -->
                    <Border
                        Grid.Column="1"
                        Padding="16,12"
                        BackgroundColor="{StaticResource PrimaryTeal}"
                        StrokeThickness="0">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="8" />
                        </Border.StrokeShape>
                        <Border.GestureRecognizers>
                            <TapGestureRecognizer Command="{Binding GoToCreateCommand}" />
                        </Border.GestureRecognizers>
                        <VerticalStackLayout HorizontalOptions="Center" Spacing="4">
                            <Label
                                FontFamily="MaterialIconsOutlined-Regular"
                                FontSize="24"
                                HorizontalOptions="Center"
                                Text="&#xe145;"
                                TextColor="White" />
                            <Label
                                FontAttributes="Bold"
                                HorizontalOptions="Center"
                                Style="{StaticResource CaptionTextStyle}"
                                Text="Create"
                                TextColor="White" />
                        </VerticalStackLayout>
                    </Border>
                </Grid>
            </VerticalStackLayout>

            <!--  Loading Overlay  -->
            <views:ReusableLoadingOverlay IsVisible="{Binding IsLoading}" />

        </VerticalStackLayout>
    </ScrollView>

</ContentPage>
