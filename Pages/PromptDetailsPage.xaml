<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="QuickPrompt.Pages.PromptDetailsPage"
             Title="Detalles Del Prompt">

    <ScrollView>
        <VerticalStackLayout Padding="20">
            <Label Text="{Binding PromptTitle}" FontSize="24" FontAttributes="Bold" HorizontalOptions="Center"  Margin="0,10,0,0"/>

            <Label Text="{Binding Description}" FontSize="18" FontAttributes="Italic" HorizontalOptions="Center"  Margin="0,10,0,0"/>

            <Label Text="{Binding PromptText}" FontSize="18" FontAttributes="Italic" HorizontalOptions="Center"  Margin="0,10,0,0"/>

            <ScrollView>
                <VerticalStackLayout>
                    <Label Text="Completa las variables:" FontSize="20" FontAttributes="Bold"  Margin="0,10,0,0"/>

                    <CollectionView ItemsSource="{Binding Variables}"  IsEnabled="{Binding IsLoading, Converter={StaticResource InverseBoolConverter}}">
                        <CollectionView.ItemTemplate>
                            <DataTemplate>
                                <VerticalStackLayout Padding="10">
                                    <Label Text="{Binding Name}" FontSize="18" FontAttributes="Bold" />
                                    <Entry Placeholder="Ingresa el valor..." Text="{Binding Value}" />
                                </VerticalStackLayout>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>

                    <Button Text="Generar Prompt" Command="{Binding GeneratePromptCommand}"  Margin="0,10,0,0"   Style="{StaticResource WarningButtonStyle}"  IsVisible="{Binding IsLoading, Converter={StaticResource InverseBoolConverter}}"/>



                    <!--<Button Text="Guardar Valores" Command="{Binding GeneratePromptCommand}"  Margin="0,10,0,0"   Style="{StaticResource PrimaryButtonStyle}"/>-->
                </VerticalStackLayout>
            </ScrollView>

            <Label Text="{Binding FinalPrompt}" FontSize="18" FontAttributes="Italic" HorizontalOptions="Center"  Margin="0,10,0,0"/>

            <Button Text="Enviar a ChatGPT"         IsVisible="{Binding IsLoading, Converter={StaticResource InverseBoolConverter}}"
                    Command="{Binding SendPromptToChatGPTCommand}"
                    Style="{StaticResource PrimaryButtonStyle}" />

            <!-- Indicador de Carga -->
            <ActivityIndicator IsRunning="{Binding IsLoading}"
                               IsVisible="{Binding IsLoading}"
                               Color="{StaticResource PrimaryGreen}"
                               HeightRequest="50"
                               VerticalOptions="Center" />

        </VerticalStackLayout>

    </ScrollView>

</ContentPage>