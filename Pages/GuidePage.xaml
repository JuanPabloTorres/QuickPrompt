<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="QuickPrompt.Pages.GuidePage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:view="clr-namespace:QuickPrompt.Views"
    BackgroundColor="WhiteSmoke"
    Routing.Route="GuidePage"
    AutomationProperties.Name="QuickPrompt Guide Page"
    AutomationProperties.HelpText="Onboarding guide for QuickPrompt application">

    <Shell.BackButtonBehavior>
        <BackButtonBehavior IsVisible="False" />
    </Shell.BackButtonBehavior>

    <Shell.TitleView>
        <view:TitleHeader
            x:Name="titleHeader"
            Title="Quick Prompt Guide"
            BackCommand="{Binding MyBackCommand}"
            Glyph="&#xe5cd;"
            ShowBackButton="false" />
    </Shell.TitleView>
    <Border
        HorizontalOptions="Fill"
        Stroke="{StaticResource PrimaryBlueDark}"
        StrokeShape="RoundRectangle 8"
        StrokeThickness="0.2"
        Style="{StaticResource CardStyle}"
        VerticalOptions="Center">

        <Border.Background>
            <LinearGradientBrush EndPoint="0.4,2">
                <GradientStop Offset="0.20" Color="{StaticResource PrimaryBlueLight}" />
                <GradientStop Offset="0.30" Color="{StaticResource PrimaryTeal}" />
                <GradientStop Offset="0.60" Color="{StaticResource PrimaryYellow}" />
            </LinearGradientBrush>
        </Border.Background>
        <ScrollView AutomationProperties.Name="Guide Content"
                    AutomationProperties.HelpText="Scroll to read the complete guide">

            <Grid
                Padding="20"
                RowDefinitions="*,*,*,Auto,Auto"
                RowSpacing="16">



                <!--  Puedes poner aquí tu contenido  -->
                <VerticalStackLayout
                    Grid.Row="0"
                    Padding="10"
                    HorizontalOptions="Fill"
                    Spacing="10">

                    <Label
                        Grid.Row="0"
                        FontAttributes="Bold"
                        HorizontalTextAlignment="Center"
                        Style="{StaticResource DisplayTextStyle}"
                        Text="¡Welcome to Quick Prompt!"
                        TextColor="White"
                        AutomationProperties.IsInAccessibleTree="True"
                        AutomationProperties.Name="Welcome Title"
                        AutomationProperties.HelpText="Welcome to Quick Prompt application" />

                    <Label
                        FontAttributes="Italic"
                        Style="{StaticResource BodyLargeTextStyle}"
                        HorizontalOptions="Center"
                        Text="Learn. Create. Reuse. Repeat."
                        TextColor="White"
                        AutomationProperties.IsInAccessibleTree="True"
                        AutomationProperties.Name="Application Tagline" />




                </VerticalStackLayout>

                <!--  Carousel con los pasos  -->
                <CarouselView
                    x:Name="GuideCarousel"
                    Grid.Row="1"
                    IndicatorView="StepIndicator"
                    IsSwipeEnabled="True"
                    ItemsSource="{Binding GuideSteps}"
                    Position="{Binding CurrentStepIndex, Mode=TwoWay}"
                    PositionChanged="OnCarouselPositionChanged"
                    AutomationProperties.Name="Guide Steps Carousel"
                    AutomationProperties.HelpText="Swipe left or right to navigate through guide steps">
                    <CarouselView.ItemTemplate>
                        <DataTemplate>
                            <Border
                                Margin="20"
                                HorizontalOptions="Fill"
                                Stroke="Transparent"
                                StrokeShape="RoundRectangle 15,15,15,15"
                                Style="{StaticResource CardStyle}"
                                VerticalOptions="Center">

                                <Border.Shadow>
                                    <Shadow
                                        Brush="Gray"
                                        Opacity="0.5"
                                        Radius="20"
                                        Offset="10,10" />
                                </Border.Shadow>

                                <Grid RowDefinitions="Auto,Auto,Auto,Auto" VerticalOptions="Center">
                                    <Label
                                        Grid.Row="0"
                                        FontAttributes="Bold"
                                        HorizontalOptions="Center"
                                        HorizontalTextAlignment="Center"
                                        LineBreakMode="WordWrap"
                                        Style="{StaticResource Heading2TextStyle}"
                                        Text="{Binding Title}"
                                        AutomationProperties.IsInAccessibleTree="True"
                                        AutomationProperties.Name="{Binding Title}" />
                                    <Label
                                        Grid.Row="1"
                                        HorizontalTextAlignment="Center"
                                        Style="{StaticResource BodyLargeTextStyle}"
                                        Text="{Binding Description}"
                                        TextColor="Black"
                                        AutomationProperties.IsInAccessibleTree="True"
                                        AutomationProperties.Name="{Binding Description}" />

                                    <!--  Ejemplo resaltado si aplica  -->
                                    <Border
                                        Grid.Row="2"
                                        Margin="10"
                                        BackgroundColor="{StaticResource PrimaryBlueDark}"
                                        IsVisible="{Binding HasExample}"
                                        Stroke="{StaticResource PrimaryTeal}"
                                        StrokeShape="RoundRectangle 10"
                                        StrokeThickness="1"
                                        Style="{StaticResource CardStyle}">
                                        <Label
                                            FontAttributes="Italic"
                                            Style="{StaticResource BodySmallTextStyle}"
                                            HorizontalTextAlignment="Center"
                                            Text="{Binding Example}"
                                            TextColor="White"
                                            AutomationProperties.IsInAccessibleTree="True"
                                            AutomationProperties.Name="Example"
                                            AutomationProperties.HelpText="{Binding Example}" />
                                    </Border>

                                    <!--  Botón solo visible en el último paso  -->
                                    <Button
                                        Grid.Row="3"
                                        Margin="10"
                                        BackgroundColor="{StaticResource PrimaryRed}"
                                        Clicked="OnNavigateToCreatePrompt"
                                        CornerRadius="10"
                                        Style="{StaticResource BodyLargeTextStyle}"
                                        IsVisible="{Binding IsFinalStep}"
                                        Text="⚡ Create Your Prompt"
                                        TextColor="White"
                                        AutomationProperties.IsInAccessibleTree="True"
                                        AutomationProperties.Name="Create Your First Prompt Button"
                                        AutomationProperties.HelpText="Tap to navigate to prompt creation page" />
                                </Grid>
                            </Border>
                        </DataTemplate>

                    </CarouselView.ItemTemplate>
                </CarouselView>

                <!--  Indicador de paso  -->
                <IndicatorView
                    x:Name="StepIndicator"
                    Grid.Row="2"
                    Margin="10"
                    HorizontalOptions="Center"
                    IndicatorColor="LightGray"
                    IndicatorSize="8"
                    SelectedIndicatorColor="{StaticResource PrimaryRed}"
                    AutomationProperties.Name="Step Indicator"
                    AutomationProperties.HelpText="Shows current step position in the guide" />

                <Label
                    Grid.Row="3"
                    Style="{StaticResource BodySmallTextStyle}"
                    HorizontalTextAlignment="Center"
                    LineBreakMode="WordWrap"
                    Text="Swipe or tap the buttons to explore the guide and discover how to get the most out of QuickPrompt!"
                    TextColor="White"
                    AutomationProperties.IsInAccessibleTree="True"
                    AutomationProperties.Name="Navigation Instructions" />

                <!--  Botones de navegación  -->
                <Grid
                    Grid.Row="4"
                    ColumnDefinitions="Auto,Auto"
                    HorizontalOptions="Center">
                    <Button
                        x:Name="BackButton"
                        Grid.Column="0"
                        Clicked="OnBackClicked"
                        IsEnabled="{Binding CanGoBack}"
                        Style="{StaticResource YellowButtonStyle}"
                        Text=""
                        AutomationProperties.IsInAccessibleTree="True"
                        AutomationProperties.Name="Previous Step Button"
                        AutomationProperties.HelpText="Go to previous guide step">


                        <Button.ImageSource>
                            <FontImageSource
                                FontFamily="MaterialIconsOutlined-Regular"
                                Glyph="&#xe5e0;"
                                Color="White" />
                        </Button.ImageSource>
                    </Button>

                    <Button
                        x:Name="NextButton"
                        Grid.Column="1"
                        Clicked="OnNextClicked"
                        Style="{StaticResource YellowButtonStyle}"
                        Text=""
                        AutomationProperties.IsInAccessibleTree="True"
                        AutomationProperties.Name="Next Step Button"
                        AutomationProperties.HelpText="Go to next guide step or start using QuickPrompt">
                        <Button.ImageSource>
                            <FontImageSource
                                FontFamily="MaterialIconsOutlined-Regular"
                                Glyph="&#xe5e1;"
                                Color="White" />
                        </Button.ImageSource>
                    </Button>
                </Grid>

            </Grid>
        </ScrollView>
    </Border>




</ContentPage>