<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="QuickPrompt.Pages.GuidePage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:view="clr-namespace:QuickPrompt.Views"
    BackgroundColor="WhiteSmoke"
    Routing.Route="GuidePage">

    <Shell.BackButtonBehavior>
        <BackButtonBehavior IsVisible="False" />
    </Shell.BackButtonBehavior>

    <Shell.TitleView>
        <view:TitleHeader
            Title="Quick Prompt Guide"
            BackCommand="{Binding MyBackCommand}"
            Glyph="&#xe5cd;"
            ShowBackButton="True" />
    </Shell.TitleView>

    <Grid
        Padding="20"
        RowDefinitions="*,Auto,Auto"
        RowSpacing="16">

        <!--  Carousel con los pasos  -->
        <CarouselView
            x:Name="GuideCarousel"
            IndicatorView="StepIndicator"
            IsSwipeEnabled="True"
            ItemsSource="{Binding GuideSteps}"
            Position="{Binding CurrentStepIndex, Mode=TwoWay}">
            <CarouselView.ItemTemplate>
                <DataTemplate>
                    <Border
                        HorizontalOptions="Fill"
                        Style="{StaticResource CardStyle}"
                        VerticalOptions="Center">
                        <VerticalStackLayout
                            Padding="10"
                            Spacing="10"
                            VerticalOptions="Center">
                            <Label
                                FontAttributes="Bold"
                                FontSize="25"
                                HorizontalOptions="Center"
                                Style="{StaticResource TitleLabelStyle}"
                                Text="{Binding Title}" />
                            <Label
                                FontSize="16"
                                HorizontalTextAlignment="Start"
                                Style="{StaticResource SubtitleLabelStyle}"
                                Text="{Binding Description}"
                                TextColor="Black" />

                            <!--  Ejemplo resaltado si aplica  -->
                            <Border
                                BackgroundColor="{StaticResource PrimaryBlueDark}"
                                IsVisible="{Binding HasExample}"
                                Stroke="{StaticResource PrimaryTeal}"
                                StrokeShape="RoundRectangle 10"
                                StrokeThickness="1"
                                Style="{StaticResource CardStyle}">
                                <Label
                                    FontAttributes="Italic"
                                    FontSize="14"
                                    HorizontalTextAlignment="Center"
                                    Text="{Binding Example}"
                                    TextColor="White" />
                            </Border>

                            <!--  Botón solo visible en el último paso  -->
                            <Button
                                BackgroundColor="{StaticResource PrimaryRed}"
                                Clicked="OnNavigateToCreatePrompt"
                                CornerRadius="10"
                                FontSize="16"
                                HeightRequest="48"
                                IsVisible="{Binding IsFinalStep}"
                                Text="⚡ Create Your Prompt"
                                TextColor="White" />
                        </VerticalStackLayout>
                    </Border>
                </DataTemplate>

            </CarouselView.ItemTemplate>
        </CarouselView>

        <!--  Indicador de paso  -->
        <IndicatorView
            x:Name="StepIndicator"
            Grid.Row="1"
            Margin="0,10"
            HorizontalOptions="Center"
            IndicatorColor="LightGray"
            IndicatorSize="10"
            SelectedIndicatorColor="Orange" />

        <!--  Botones de navegación  -->
        <Grid
            Grid.Row="2"
            ColumnDefinitions="Auto,Auto"
            HorizontalOptions="Center">
            <Button
                x:Name="BackButton"
                Grid.Column="0"
                Clicked="OnBackClicked"
                IsEnabled="{Binding CanGoBack}"
                Style="{StaticResource YellowButtonStyle}"
                Text="">


                <Button.ImageSource>
                    <FontImageSource
                        FontFamily="MaterialIconsOutlined-Regular"
                        Glyph="&#xe5e0;"
                        Color="White" />
                </Button.ImageSource>
            </Button>

            <Button
                x:Name="NextButton"
                Grid.Column="1"
                Clicked="OnNextClicked"
                Style="{StaticResource YellowButtonStyle}"
                Text="">
                <Button.ImageSource>
                    <FontImageSource
                        FontFamily="MaterialIconsOutlined-Regular"
                        Glyph="&#xe5e1;"
                        Color="White" />
                </Button.ImageSource>
            </Button>
        </Grid>

    </Grid>





</ContentPage>