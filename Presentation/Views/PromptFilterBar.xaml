<?xml version="1.0" encoding="utf-8" ?>
<ContentView
    x:Class="QuickPrompt.Views.PromptFilterBar"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:enums="clr-namespace:QuickPrompt.Tools"
    x:Name="Root"
    IsVisible="{Binding IsLoading, Converter={StaticResource InverseBoolConverter}}">

    <Border
        Padding="16"
        BackgroundColor="{StaticResource CardBackground}"
        StrokeThickness="0">
        <Border.StrokeShape>
            <RoundRectangle CornerRadius="12" />
        </Border.StrokeShape>
        <Border.Shadow>
            <Shadow
                Brush="{StaticResource AppBlack}"
                Opacity="0.08"
                Radius="12"
                Offset="0,4" />
        </Border.Shadow>

        <VerticalStackLayout Spacing="16">

            <!--  Search Section  -->
            <VerticalStackLayout Spacing="8">
                <Label
                    FontAttributes="Bold"
                    Style="{StaticResource BodySmallTextStyle}"
                    Text="ðŸ” Search"
                    TextColor="{StaticResource TextPrimary}" />

                <Grid ColumnDefinitions="*,Auto" ColumnSpacing="8">
                    <Border
                        Grid.Column="0"
                        BackgroundColor="{StaticResource SurfaceBackground}"
                        Stroke="{StaticResource BorderLight}"
                        StrokeThickness="1">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="8" />
                        </Border.StrokeShape>

                        <Entry
                            ClearButtonVisibility="WhileEditing"
                            FontFamily="Nasa21"
                            FontSize="14"
                            HeightRequest="{StaticResource InputHeightMedium}"
                            Placeholder="Search by title or description..."
                            PlaceholderColor="{StaticResource TextSecondary}"
                            ReturnCommand="{Binding SearchCommand, Source={x:Reference Root}}"
                            ReturnType="Search"
                            Text="{Binding SearchText, Source={x:Reference Root}, Mode=TwoWay}"
                            TextColor="{StaticResource TextPrimary}"
                            VerticalOptions="Center" />
                    </Border>

                    <Button
                        Grid.Column="1"
                        Padding="0"
                        BackgroundColor="{StaticResource PrimaryBlueDark}"
                        Command="{Binding SearchCommand, Source={x:Reference Root}}"
                        CornerRadius="8"
                        HeightRequest="48"
                        ToolTipProperties.Text="Search"
                        WidthRequest="48">
                        <Button.ImageSource>
                            <FontImageSource
                                FontFamily="MaterialIconsOutlined-Regular"
                                Glyph="&#xe8b6;"
                                Size="20"
                                Color="{StaticResource White}" />
                        </Button.ImageSource>
                    </Button>
                </Grid>
            </VerticalStackLayout>

            <!--  Divider  -->
            <BoxView BackgroundColor="{StaticResource BorderLight}" HeightRequest="1" />

            <!--  Category Filter Section  -->
            <VerticalStackLayout Spacing="8">
                <Label
                    FontAttributes="Bold"
                    Style="{StaticResource BodySmallTextStyle}"
                    Text="ðŸ“ Category"
                    TextColor="{StaticResource TextPrimary}" />

                <Border
                    BackgroundColor="{StaticResource SurfaceBackground}"
                    Stroke="{StaticResource BorderLight}"
                    StrokeThickness="1">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="8" />
                    </Border.StrokeShape>

                    <Picker
                        Title="All Categories"
                        FontFamily="Nasa21"
                        FontSize="14"
                        HeightRequest="{StaticResource InputHeightMedium}"
                        ItemsSource="{Binding Categories, Source={x:Reference Root}}"
                        SelectedItem="{Binding SelectedCategory, Source={x:Reference Root}, Mode=TwoWay}"
                        TextColor="{StaticResource TextPrimary}"
                        TitleColor="{StaticResource TextSecondary}"
                        VerticalOptions="Center" />
                </Border>
            </VerticalStackLayout>

            <!--  Divider  -->
            <BoxView BackgroundColor="{StaticResource BorderLight}" HeightRequest="1" />

            <!--  Quick Filters Section  -->
            <VerticalStackLayout Spacing="12">
                <Label
                    FontAttributes="Bold"
                    Style="{StaticResource BodySmallTextStyle}"
                    Text="âš¡ Quick Filters"
                    TextColor="{StaticResource TextPrimary}" />

                <!--  Favorites Row  -->
                <Grid ColumnDefinitions="*,*" ColumnSpacing="8">

                    <!--  Favorites Button  -->
                    <Border
                        Grid.Column="0"
                        BackgroundColor="{Binding SelectedDateFilter, Converter={StaticResource FilterToColorConverter}, ConverterParameter={x:Static enums:Filters.Favorites}}"
                        Stroke="{StaticResource BorderLight}"
                        StrokeThickness="1">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="8" />
                        </Border.StrokeShape>

                        <Border.GestureRecognizers>
                            <TapGestureRecognizer Command="{Binding SelectFilterCommand}" CommandParameter="{x:Static enums:Filters.Favorites}" />
                        </Border.GestureRecognizers>

                        <HorizontalStackLayout
                            Padding="12,10"
                            HorizontalOptions="Center"
                            Spacing="8">
                            <Image>
                                <Image.Source>
                                    <FontImageSource
                                        FontFamily="MaterialIconsOutlined-Regular"
                                        Glyph="&#xe3e7;"
                                        Size="18"
                                        Color="{StaticResource PrimaryYellow}" />
                                </Image.Source>
                            </Image>
                            <Label
                                FontAttributes="Bold"
                                FontFamily="Nasa21"
                                FontSize="13"
                                Text="Favorites"
                                TextColor="{StaticResource TextPrimary}"
                                VerticalOptions="Center" />
                        </HorizontalStackLayout>
                    </Border>

                    <!--  Non-Favorites Button  -->
                    <Border
                        Grid.Column="1"
                        BackgroundColor="{Binding SelectedDateFilter, Converter={StaticResource FilterToColorConverter}, ConverterParameter={x:Static enums:Filters.NonFavorites}}"
                        Stroke="{StaticResource BorderLight}"
                        StrokeThickness="1">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="8" />
                        </Border.StrokeShape>

                        <Border.GestureRecognizers>
                            <TapGestureRecognizer Command="{Binding SelectFilterCommand}" CommandParameter="{x:Static enums:Filters.NonFavorites}" />
                        </Border.GestureRecognizers>

                        <HorizontalStackLayout
                            Padding="12,10"
                            HorizontalOptions="Center"
                            Spacing="8">
                            <Image>
                                <Image.Source>
                                    <FontImageSource
                                        FontFamily="MaterialIconsOutlined-Regular"
                                        Glyph="&#xe3e6;"
                                        Size="18"
                                        Color="{StaticResource TextSecondary}" />
                                </Image.Source>
                            </Image>
                            <Label
                                FontAttributes="Bold"
                                FontFamily="Nasa21"
                                FontSize="13"
                                Text="Regular"
                                TextColor="{StaticResource TextPrimary}"
                                VerticalOptions="Center" />
                        </HorizontalStackLayout>
                    </Border>
                </Grid>

                <!--  Date Filters Row  -->
                <Grid ColumnDefinitions="*,*" ColumnSpacing="8">

                    <!--  Today Button  -->
                    <Border
                        Grid.Column="0"
                        BackgroundColor="{Binding SelectedDateFilter, Converter={StaticResource FilterToColorConverter}, ConverterParameter={x:Static enums:Filters.Today}}"
                        Stroke="{StaticResource BorderLight}"
                        StrokeThickness="1">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="8" />
                        </Border.StrokeShape>

                        <Border.GestureRecognizers>
                            <TapGestureRecognizer Command="{Binding SelectFilterCommand}" CommandParameter="{x:Static enums:Filters.Today}" />
                        </Border.GestureRecognizers>

                        <HorizontalStackLayout
                            Padding="12,10"
                            HorizontalOptions="Center"
                            Spacing="8">
                            <Image>
                                <Image.Source>
                                    <FontImageSource
                                        FontFamily="MaterialIconsOutlined-Regular"
                                        Glyph="&#xe8df;"
                                        Size="18"
                                        Color="{StaticResource PrimaryTeal}" />
                                </Image.Source>
                            </Image>
                            <Label
                                FontAttributes="Bold"
                                FontFamily="Nasa21"
                                FontSize="13"
                                Text="Today"
                                TextColor="{StaticResource TextPrimary}"
                                VerticalOptions="Center" />
                        </HorizontalStackLayout>
                    </Border>

                    <!--  Last 7 Days Button  -->
                    <Border
                        Grid.Column="1"
                        BackgroundColor="{Binding SelectedDateFilter, Converter={StaticResource FilterToColorConverter}, ConverterParameter={x:Static enums:Filters.Last7Days}}"
                        Stroke="{StaticResource BorderLight}"
                        StrokeThickness="1">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="8" />
                        </Border.StrokeShape>

                        <Border.GestureRecognizers>
                            <TapGestureRecognizer Command="{Binding SelectFilterCommand}" CommandParameter="{x:Static enums:Filters.Last7Days}" />
                        </Border.GestureRecognizers>

                        <HorizontalStackLayout
                            Padding="12,10"
                            HorizontalOptions="Center"
                            Spacing="8">
                            <Image>
                                <Image.Source>
                                    <FontImageSource
                                        FontFamily="MaterialIconsOutlined-Regular"
                                        Glyph="&#xe916;"
                                        Size="18"
                                        Color="{StaticResource Info600}" />
                                </Image.Source>
                            </Image>
                            <Label
                                FontAttributes="Bold"
                                FontFamily="Nasa21"
                                FontSize="13"
                                Text="Last 7 Days"
                                TextColor="{StaticResource TextPrimary}"
                                VerticalOptions="Center" />
                        </HorizontalStackLayout>
                    </Border>
                </Grid>

                <!--  All Filter Button  -->
                <Border
                    BackgroundColor="{Binding SelectedDateFilter, Converter={StaticResource FilterToColorConverter}, ConverterParameter={x:Static enums:Filters.All}}"
                    Stroke="{StaticResource BorderLight}"
                    StrokeThickness="1">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="8" />
                    </Border.StrokeShape>

                    <Border.GestureRecognizers>
                        <TapGestureRecognizer Command="{Binding SelectFilterCommand}" CommandParameter="{x:Static enums:Filters.All}" />
                    </Border.GestureRecognizers>

                    <HorizontalStackLayout
                        Padding="12,10"
                        HorizontalOptions="Center"
                        Spacing="8">
                        <Image>
                            <Image.Source>
                                <FontImageSource
                                    FontFamily="MaterialIconsOutlined-Regular"
                                    Glyph="&#xe8ef;"
                                    Size="18"
                                    Color="{StaticResource PrimaryBlueDark}" />
                            </Image.Source>
                        </Image>
                        <Label
                            FontAttributes="Bold"
                            FontFamily="Nasa21"
                            FontSize="13"
                            Text="All Prompts"
                            TextColor="{StaticResource TextPrimary}"
                            VerticalOptions="Center" />
                    </HorizontalStackLayout>
                </Border>
            </VerticalStackLayout>

        </VerticalStackLayout>
    </Border>

</ContentView>